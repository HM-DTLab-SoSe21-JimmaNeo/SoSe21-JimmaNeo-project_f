@page "/resultstest/"

@inject Services.TestsDefinitionBackendAccessService TestDefinitionService
@inject NavigationManager NavigationManager
@inject Services.CompletedTestBackendAccessService CompletedTestService

@using static RunTest


<div class="container">

    @if (RunTest.TestDto != null)
    {
        <h2 class="text-center">Results of @(RunTest.TestDto.Topic)</h2>
        <hr class="divider">
        <h3 class="text-center"><b>Your score: @(RunTest.CompletedTestDTO.ReachedPoints)/@(RunTest.CompletedTestDTO.MaxPoints) Points</b></h3>
        <ul class="list-group list-group-flush">

            @foreach (var question in RunTest.TestDto.Questions)
            {

                <div class="card shadow">
                    <div class="card-body">
                <li class="text-center list-group-item">
                    <h4>@(question.QuestionText)</h4>
                </li>
                @foreach (var answer in question.Answers)
                {

                    <li class="text-center list-group-item">
                        <label>@(answer.AnswerText)</label><br />

                        @if (answer.IsClicked)
                        {
                            <label style="color:blue">Your answer</label><br />
                        }
                        else if(!answer.IsClicked && answer.IsCorrect)
                        {
                            <label style="color:red">Not your answer</label><br />
                        }

                        @if (answer.IsCorrect)
                        {
                            <label style="color:green">This is the Right Answer</label>

                        }
                        else if (answer.IsClicked && !answer.IsCorrect)
                        {
                            <label style="color:red"> Wrong Answer</label>
                        }

                    </li>
                }
                @if (question.Explanation != null)
                {
                    <li class="text-center list-group-item">
                        <div class="card border-success">
                            <div class="card-body">
                                <h4>Explanation:</h4> <br />
                                <p>@(question.Explanation)</p>
                            </div>
                        </div>
                    </li>
                }
        </div>
        </div>
                <br/>
    }
            </ul>
            <div class="text-center py-2">
                <button class="btn btn-dark shadow" @onclick="() => GoToFurtherInformationPage()">Get more information</button>
            </div>
            <div class="text-center py-2">
                <button class="btn btn-light btn-sm shadow" @onclick="() => ReturnBackToTestOverview()">Return To Overview</button>
            </div>

        }

    </div>

    @code{

        private void ReturnBackToTestOverview()
        {
            NavigationManager.NavigateTo("/testoverview/");
        }

        private void GoToFurtherInformationPage()
        {
            NavigationManager.NavigateTo("/furtherinformation/" + RunTest.TestDto.TestID);
        }
    }

